; M5 Pomodoro Timer v2 - PlatformIO Configuration
; Platform: M5Stack Core2 (ESP32-D0WDQ6-V3)

[platformio]
default_envs = m5stack-core2

[env:m5stack-core2]
platform = espressif32@6.5.0
board = m5stack-core2
framework = arduino

; Build flags
build_flags =
    -DCORE_DEBUG_LEVEL=3
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    -DARDUINO_M5STACK_CORE2
    -DM5UNIFIED_PC_SUPPORT=0
    ; Version info
    -DFIRMWARE_VERSION=\"2.0.0\"
    ; Features
    -DENABLE_CLOUD_SYNC=1
    -DENABLE_TOGGL=1
    -DENABLE_GCAL=1
    -DENABLE_AUDIO=1
    -DENABLE_LED=1

; Board configuration
board_build.partitions = partitions.csv
board_build.filesystem = littlefs
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L
board_build.flash_mode = qio
board_build.psram_type = qspi

; Upload configuration
upload_speed = 921600
monitor_speed = 115200
monitor_filters =
    esp32_exception_decoder
    time
    colorize

; Dependencies
lib_deps =
    m5stack/M5Unified@^0.1.13
    bblanchon/ArduinoJson@^7.0.3
    knolleary/PubSubClient@^2.8.0
    arduino-libraries/NTPClient@^3.2.1

; Test configuration
test_framework = googletest
test_build_src = yes

; Debugging
debug_tool = esp-prog
debug_init_break = tbreak setup
